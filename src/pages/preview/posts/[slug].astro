---
import { Container } from "../../../components/container";
import HeaderBlog from "../../../components/header-blog";
import MoreStories from "../../../components/more-stories";
import { Post } from "../../../components/post";
import SectionSeparator from "../../../components/section-separator";
import Layout from "../../../components/layout";
import { getPostBySlug, getPosts } from "../../../features";
import { getPostPaths } from "../../../utils";

const { slug } = Astro.params

const previewMode = true

const postsResult = await getPostBySlug(previewMode)(slug as string);

const { post, morePosts } = postsResult;

export async function getStaticPaths() {
  const posts = await getPosts(true);

  return getPostPaths(posts);
}
---

<Layout previewMode={previewMode} currentSlug={`posts/${slug}`}>
  <Container>
    <HeaderBlog preview={previewMode} />
    <Post post={post} />
    <SectionSeparator />
    <MoreStories preview={previewMode} posts={morePosts} />
  </Container>
</Layout>